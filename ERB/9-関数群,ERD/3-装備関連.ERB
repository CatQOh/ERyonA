@装備DT作成
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC LCOUNT2
{
#DIMS DYNAMIC DTNAME =
"武器",
"防具",
"頭装備",
"足装備",
"アクセサリ",
"武器一覧",
"防具一覧",
"頭装備一覧",
"足装備一覧",
"アクセサリ一覧",
}
{
#DIMS DYNAMIC COLUMNNAME = 
"名前",
"レア度",
"装備中",
"耐久値",
"分類",
"攻撃力",
"防御力",
"命中率",
"特殊効果",
"重量",
"必要筋力",
"必要耐久",
"必要知性",
"必要器用",
"必要感覚",
"必要運勢",
"説明",
}

FOR LCOUNT, 0, VARSIZE("DTNAME")
	DT_CREATE DTNAME:LCOUNT
	SIF !RESULT
		CONTINUE
	FOR LCOUNT2, 0, VARSIZE("COLUMNNAME")
		SELECTCASE COLUMNNAME:LCOUNT2
			CASE "名前", "分類", "特殊効果", "説明"
				DT_COLUMN_ADD DTNAME:LCOUNT, COLUMNNAME:LCOUNT2
			CASE "装備中"
				DT_COLUMN_ADD DTNAME:LCOUNT, COLUMNNAME:LCOUNT2, "int64"
			CASE "耐久値", "重量"
				DT_COLUMN_ADD DTNAME:LCOUNT, COLUMNNAME:LCOUNT2, "int16"
			CASEELSE
				DT_COLUMN_ADD DTNAME:LCOUNT, COLUMNNAME:LCOUNT2, "int8"
		ENDSELECT
	NEXT
NEXT

@装備一覧
;テンプレ
;{
;DT_ROW_ADD "武器", "名前", "", "レア度", , "耐久値", , "分類", "",
;"攻撃力", , "防御力", , "命中率", , "特殊効果", "", "重量", ,
;"必要筋力", , "必要耐久", , "必要知性", , "必要器用", , "必要感覚", , "必要運勢", ,
;"説明", ""
;}
{
DT_ROW_ADD "武器一覧", "名前", "ショートソード", "レア度", 1, "耐久値", 30, "分類", "剣",
"攻撃力", 3, "命中率", 90, "重量", 3,
"説明", "軽くて扱いやすい短剣"
}
{
DT_ROW_ADD "武器一覧", "名前", "ロングソード", "レア度", 2, "耐久値", 50, "分類", "剣",
"攻撃力", 5, "命中率", 80, "重量", 7,
"必要筋力", 2,
"説明", "戦闘向けの両刃の剣"
}
{
DT_ROW_ADD "武器一覧", "名前", "レイピア", "レア度", 3, "耐久値", 20, "分類", "剣",
"攻撃力", 4, "命中率", 95, "特殊効果", "回避率上昇*10", "重量", 3,
"必要器用", 3,
"説明", "脆いが非常に軽く、かつ鋭利な剣"
}
{
DT_ROW_ADD "武器一覧", "名前", "刀", "レア度", 6, "耐久値", 50, "分類", "剣",
"攻撃力", 7, "命中率", 90, "重量", 5,
"必要筋力", 2, "必要器用", 3, "必要感覚", 3,
"説明", "切れ味を追求した攻撃力の高い片刃の剣"
}
{
DT_ROW_ADD "武器一覧", "名前", "ハンドアックス", "レア度", 1, "耐久値", 50, "分類", "斧",
"攻撃力", 5, "命中率", 60, "重量", 10,
"必要筋力", 4,
"説明", "伐採用の手斧。重くて取り回しが悪い"
}
{
DT_ROW_ADD "武器一覧", "名前", "バトルアックス", "レア度", 3, "耐久値", 100, "分類", "斧",
"攻撃力", 8, "命中率", 50, "重量", 20,
"必要筋力", 8,
"説明", "破壊的な戦闘用の斧"
}
{
DT_ROW_ADD "武器一覧", "名前", "ピストル", "レア度", 2, "耐久値", 30, "分類", "銃",
"攻撃力", 5, "命中率", 70, "重量", 5,
"必要器用", 3,
"説明", "扱いやすい拳銃"
}
{
DT_ROW_ADD "武器一覧", "名前", "ライフル", "レア度", 4, "耐久値", 50, "分類", "銃",
"攻撃力", 7, "命中率", 80, "重量", 10,
"必要器用", 8,
"説明", "火力と命中率を高めた単発銃"
}
{
DT_ROW_ADD "武器一覧", "名前", "散弾銃", "レア度", 4, "耐久値", 30, "分類", "銃",
"攻撃力", 10, "命中率", 50, "重量", 15,
"必要筋力" , 4, "必要器用", 6, "必要感覚", 4,
"説明", "一発の威力に重きを置いた銃"
}
{
DT_ROW_ADD "武器一覧", "名前", "バックラー", "レア度", 1, "耐久値", 30, "分類", "盾",
"防御力", 3, "重量", 3,
"必要耐久", 1,
"説明", "簡素な作りの小さい盾"
}
{
DT_ROW_ADD "武器一覧", "名前", "シールド", "レア度", 3, "耐久値", 100, "分類", "盾",
"防御力", 7, "重量", 10,
"必要筋力", 2, "必要耐久", 4,
"説明", "堅牢な作りの中型の盾"
}
{
DT_ROW_ADD "武器一覧", "名前", "タワーシールド", "レア度", 5, "耐久値", 200, "分類", "盾",
"防御力", 15, "重量", 25,
"必要筋力", 5, "必要耐久", 10,
"説明", "背丈ほどもある巨大な厚い盾"
}
{
DT_ROW_ADD "武器一覧", "名前", "ワンド", "レア度", 1, "耐久値", 50, "分類", "杖",
"攻撃力", 2, "命中率", 90, "重量", 3,
"必要知性", 2,
"説明", "微弱な魔力が宿った木製の杖"
}
{
DT_ROW_ADD "武器一覧", "名前", "錫杖", "レア度", 5, "耐久値", 100, "分類", "杖",
"攻撃力", 5, "命中率", 90, "特殊効果", "運勢上昇*2", "重量", 5,
"必要知性", 6, "必要感覚", 4,
"説明", "神の加護が得られる金属製の杖"
}

{
DT_ROW_ADD "防具一覧", "名前", "ローブ", "レア度", 1, "耐久値", 10,
"防御力", 1, "特殊効果", "回避率上昇*5", "重量", 1,
"説明", "戦闘には適さない布の服。軽さだけが取り柄"
}
{
DT_ROW_ADD "防具一覧", "名前", "レザーアーマー", "レア度", 1, "耐久値", 30,
"防御力", 3, "重量", 3,
"必要耐久", 1,
"説明", "多少の攻撃なら通さない革製の鎧"
}
{
DT_ROW_ADD "防具一覧", "名前", "スケイルアーマー", "レア度", 2, "耐久値", 50,
"防御力", 5, "重量", 7,
"必要筋力", 1, "必要耐久", 2,
"説明", "防御力と軽さのバランスが取れた鎧"
}
{
DT_ROW_ADD "防具一覧", "名前", "チェインメイル", "レア度", 3, "耐久値", 70,
"防御力", 7, "重量", 10,
"必要筋力", 3, "必要耐久", 5,
"説明", "並の攻撃は通さない重量級の鎧"
}
{
DT_ROW_ADD "防具一覧", "名前", "プレートアーマー", "レア度", 4, "耐久値", 100,
"防御力", 10, "重量", 15,
"必要筋力", 5, "必要耐久", 7,
"説明", "非常に重く非常に堅牢な鎧"
}

{
DT_ROW_ADD "頭装備一覧", "名前", "三角帽子", "レア度", 2, "耐久値", 30,
"防御力", 1, "特殊効果", "魔法増強*1", "重量", 1,
"必要知性", 2,
"説明", "魔法の威力を高める帽子"
}
{
DT_ROW_ADD "頭装備一覧", "名前", "ヘルメット", "レア度", 2, "耐久値", 50,
"防御力", 2, "重量", 2,
"必要耐久", 1,
"説明", "防御力に貢献できる頭装備"
}

{
DT_ROW_ADD "足装備一覧", "名前", "サンダル", "レア度", 1, "耐久値", 30,
"防御力", 1, "重量", 1,
"説明", "裸足よりはマシな装備"
}
{
DT_ROW_ADD "足装備一覧", "名前", "ブーツ", "レア度", 2, "耐久値", 50,
"防御力", 2, "重量", 1,
"必要耐久", 1,
"説明", "足元の安定性を高めてくれる靴"
}
{
DT_ROW_ADD "アクセサリ一覧", "名前", "護符", "レア度", 4, "耐久値", 100,
"特殊効果", "状態異常回避*5", "重量", 1,
"必要感覚", 3,
"説明", "あらゆる状態異常を低確率で回避できる護符"
}
{
DT_ROW_ADD "防具", "名前", "身代りの護符", "レア度", 10, "耐久値", 1,
"特殊効果", "致命傷回避", "重量", 1,
"必要運勢", 8,
"説明", "一度だけ致命傷を無効化する護符"
}

;;;指定した名前の武器を追加する
@武器追加, 武器名, 補正値
#DIMS DYNAMIC 武器名
#DIM DYNAMIC 補正値
#DIM DYNAMIC LCOUNT
#DIM DYNAMIC ROWIDFROM
#DIM DYNAMIC ROWIDTO
{
#DIMS DYNAMIC COLUMNNAME = 
"名前",
"レア度",
"装備中",
"耐久値",
"分類",
"攻撃力",
"防御力",
"命中率",
"特殊効果",
"重量",
"必要筋力",
"必要耐久",
"必要知性",
"必要器用",
"必要感覚",
"必要運勢",
"説明",
}

FOR LCOUNT, 0, DT_ROW_LENGTH("武器一覧")
	IF DT_CELL_GETS("武器一覧", LCOUNT, "名前") == 武器名
		ROWIDFROM = LCOUNT
		BREAK
	ENDIF
NEXT

DT_ROW_ADD "武器"
ROWIDTO = DT_ROW_LENGTH("武器")-1

FOR LCOUNT, 0, VARSIZE("COLUMNNAME")
	SIF DT_CELL_ISNULL("武器一覧", ROWIDFROM, COLUMNNAME:LCOUNT)
		CONTINUE
	SELECTCASE DT_COLUMN_EXIST("武器一覧", COLUMNNAME:LCOUNT)
		CASE 5
			DT_CELL_SET "武器", ROWIDTO, COLUMNNAME:LCOUNT, DT_CELL_GETS("武器一覧", ROWIDFROM, COLUMNNAME:LCOUNT)
		CASEELSE
			DT_CELL_SET "武器", ROWIDTO, COLUMNNAME:LCOUNT, DT_CELL_GET("武器一覧", ROWIDFROM, COLUMNNAME:LCOUNT)
	ENDSELECT
NEXT

RETURN
